{"ast":null,"code":"var _jsxFileName = \"/Users/weixinliang/Desktop/project3/current/learnlocal-p3/client/src/components/ClassCard/MapBox.js\";\nimport React, { Fragment, useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport styles from './MapClassCard.css';\nimport ReactMapboxGl from 'react-mapbox-gl';\nimport ClassCard from './ClassCard';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { getProfiles } from '../../actions/profile';\nimport Geocode from 'react-geocode';\nGeocode.setApiKey('AIzaSyBKMivIunMptvLe8cBRYFsGZ3PBZKPp3yU');\nGeocode.enableDebug();\nconst Map = ReactMapboxGl({\n  accessToken: 'pk.eyJ1IjoibGVhcm5sb2NhbCIsImEiOiJjanlkZ2dram4wcHY1M2ptZm8wNGZrNzVkIn0.SnFaLsmeVQkX5XSj8-pp-A'\n});\nconst chapters = {\n  'wooden-heart-pendants': {\n    bearing: 27,\n    center: [-122.59213, 37.983088],\n    zoom: 15.5,\n    pitch: 20\n  },\n  'aldgate': {\n    duration: 6000,\n    center: [-0.07571203, 51.51424049],\n    bearing: 150,\n    zoom: 15,\n    pitch: 0\n  }\n};\n\nconst handleScroll = () => {\n  const chapterNames = Object.keys(chapters);\n\n  for (let i = 0; i < chapterNames.length; i++) {\n    let chapterName = chapterNames[i];\n\n    if (isElementOnScreen(chapterName)) {\n      console.log('handleScroll | chapterName', chapterName);\n      setActiveChapter(chapterName);\n      break;\n    }\n  }\n};\n\nconst setActiveChapter = chapterName => {\n  if (chapterName === activeChapterName) return;\n  console.log('setActiveChapter | setState to', chapters[activeChapterName]['center']); // this.setState({ 'center': chapters[activeChapterName]['center'] })\n\n  document.getElementById(chapterName).setAttribute('class', 'active');\n  document.getElementById(activeChapterName).setAttribute('class', '');\n  activeChapterName = chapterName;\n};\n\nconst isElementOnScreen = id => {\n  const element = document.getElementById(id);\n  const bounds = element.getBoundingClientRect();\n  return bounds.top < window.innerHeight && bounds.bottom - 1000 > 0;\n};\n\nlet activeChapterName = 'wooden-heart-pendants';\nlet stats = {\n  center: [-122.27087, 37.87189],\n  zoom: [15.0],\n  bearing: [0],\n  pitch: [0]\n};\n\nconst MapBox = ({\n  getProfiles,\n  profile: {\n    profiles,\n    loading\n  }\n}) => {\n  useEffect(() => {\n    window.addEventListener('scroll', handleScroll);\n    getProfiles();\n    return () => {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, [getProfiles]);\n  const addresses = profiles; // Geocode.fromAddress(\"Eiffel Tower\").then(\n  //   response => {\n  //     const { lat, lng } = response.results[0].geometry.location\n  //     console.log(lat, lng)\n  //   },\n  //   error => {\n  //     console.error(error)\n  //   }\n  // )\n\n  return React.createElement(\"div\", {\n    className: \"MapClassCardContainer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, React.createElement(Map, {\n    style: \"mapbox://styles/mapbox/streets-v10\",\n    center: stats.center,\n    zoom: stats.zoom,\n    bearing: stats.bearing,\n    pitch: stats.pitch,\n    className: \"the-map\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    id: \"features\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(\"section\", {\n    id: \"wooden-heart-pendants\",\n    class: \"active\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }), React.createElement(\"section\", {\n    id: \"aldgate\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, \"Aldgate Station\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, \"Arthur Cadogan West was found dead, head crushed in on train tracks at Aldgate Station at 6AM Tuesday morning. West worked at Woolwich Arsenal on the Bruce-Partington submarine, a secret military project. Plans for the submarine had been stolen and seven of the ten missing papers were found in West's possession. Mycroft implores Sherlock to take the case and recover the three missing papers.\")), profiles.length > 0 ? profiles.map(profile => React.createElement(ClassCard, {\n    event: profile.events,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  })) : React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"No profiles found...\")));\n};\n\nMapBox.propTypes = {\n  getProfiles: PropTypes.func.isRequired,\n  profile: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  profile: state.profile\n});\n\nexport default connect(mapStateToProps, {\n  getProfiles\n})(MapBox);","map":{"version":3,"sources":["/Users/weixinliang/Desktop/project3/current/learnlocal-p3/client/src/components/ClassCard/MapBox.js"],"names":["React","Fragment","useEffect","useState","Link","styles","ReactMapboxGl","ClassCard","PropTypes","connect","getProfiles","Geocode","setApiKey","enableDebug","Map","accessToken","chapters","bearing","center","zoom","pitch","duration","handleScroll","chapterNames","Object","keys","i","length","chapterName","isElementOnScreen","console","log","setActiveChapter","activeChapterName","document","getElementById","setAttribute","id","element","bounds","getBoundingClientRect","top","window","innerHeight","bottom","stats","MapBox","profile","profiles","loading","addEventListener","removeEventListener","addresses","map","events","propTypes","func","isRequired","object","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport styles from './MapClassCard.css'\nimport ReactMapboxGl from 'react-mapbox-gl'\nimport ClassCard from './ClassCard'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { getProfiles } from '../../actions/profile'\nimport Geocode from 'react-geocode'\n\nGeocode.setApiKey('AIzaSyBKMivIunMptvLe8cBRYFsGZ3PBZKPp3yU')\n\nGeocode.enableDebug()\n\nconst Map = ReactMapboxGl({\n  accessToken: 'pk.eyJ1IjoibGVhcm5sb2NhbCIsImEiOiJjanlkZ2dram4wcHY1M2ptZm8wNGZrNzVkIn0.SnFaLsmeVQkX5XSj8-pp-A'\n})\n\nconst chapters = {\n  'wooden-heart-pendants': {\n    bearing: 27,\n    center: [-122.59213, 37.983088],\n    zoom: 15.5,\n    pitch: 20\n  },\n  'aldgate': {\n    duration: 6000,\n    center: [-0.07571203, 51.51424049],\n    bearing: 150,\n    zoom: 15,\n    pitch: 0\n  }\n}\nconst handleScroll = () => {\n  const chapterNames = Object.keys(chapters)\n  for (let i = 0; i < chapterNames.length; i++) {\n    let chapterName = chapterNames[i]\n    if (isElementOnScreen(chapterName)) {\n      console.log('handleScroll | chapterName', chapterName)\n      setActiveChapter(chapterName)\n      break\n    }\n  }\n}\n\nconst setActiveChapter = (chapterName) => {\n  if (chapterName === activeChapterName) return\n  console.log('setActiveChapter | setState to', chapters[activeChapterName]['center'])\n  // this.setState({ 'center': chapters[activeChapterName]['center'] })\n\n  document.getElementById(chapterName).setAttribute('class', 'active')\n  document.getElementById(activeChapterName).setAttribute('class', '')\n\n  activeChapterName = chapterName\n}\n\nconst isElementOnScreen = (id) => {\n  const element = document.getElementById(id)\n  const bounds = element.getBoundingClientRect()\n  return bounds.top < window.innerHeight && bounds.bottom - 1000 > 0\n}\n\nlet activeChapterName = 'wooden-heart-pendants'\nlet stats = {\n  center: [-122.27087, 37.87189],\n  zoom: [15.0],\n  bearing: [0],\n  pitch: [0]\n}\n\nconst MapBox = ({ getProfiles, profile: { profiles, loading } }) => {\n  useEffect(() => {\n    window.addEventListener('scroll', handleScroll)\n    getProfiles()\n    return () => {\n      window.removeEventListener('scroll', handleScroll)\n    }\n  }, [getProfiles])\n  const addresses = profiles\n  // Geocode.fromAddress(\"Eiffel Tower\").then(\n  //   response => {\n  //     const { lat, lng } = response.results[0].geometry.location\n  //     console.log(lat, lng)\n  //   },\n  //   error => {\n  //     console.error(error)\n  //   }\n  // )\n  return (\n    <div className='MapClassCardContainer'>\n      <Map\n        style='mapbox://styles/mapbox/streets-v10'\n        center={stats.center}\n        zoom={stats.zoom}\n        bearing={stats.bearing}\n        pitch={stats.pitch}\n        className='the-map'\n      />\n      <div id='features'>\n        <section id='wooden-heart-pendants' class='active'>\n          {/* <ClassCard /> */}\n        </section>\n        <section id='aldgate'>\n          <h3>Aldgate Station</h3>\n          <p>Arthur Cadogan West was found dead, head crushed in on train tracks at Aldgate Station at 6AM Tuesday morning. West worked at Woolwich Arsenal on the Bruce-Partington submarine, a secret military project. Plans for the submarine had been stolen and seven of the ten missing papers were found in West's possession. Mycroft implores Sherlock to take the case and recover the three missing papers.</p>\n        </section>\n        {profiles.length > 0 ? (\n            profiles.map(profile => (\n              <ClassCard event={profile.events} />\n            ))\n          ) : (\n            <h4>No profiles found...</h4>\n          )}\n      </div>\n    </div>\n  )\n}\n\nMapBox.propTypes = {\n  getProfiles: PropTypes.func.isRequired,\n  profile: PropTypes.object.isRequired\n}\nconst mapStateToProps = state => ({\n  profile: state.profile\n})\nexport default connect(\n  mapStateToProps,\n  { getProfiles }\n)(MapBox)\n"]},"metadata":{},"sourceType":"module"}