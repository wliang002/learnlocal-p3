{"ast":null,"code":"const jwt = require('jsonwebtoken');\n\nconst config = require('config');\n\nmodule.exports = (req, res, next) => {\n  // Get token from header 'x-auto-token' is the header key\n  const token = req.header('x-auth-token'); // Check if there is no token\n\n  if (!token) {\n    return res.status(401).json({\n      msg: 'No token, authorization denied'\n    });\n  } // Verify token if there is one\n\n\n  try {\n    // decode the token with jwt and save it to decoded\n    const decoded = jwt.verify(token, config.get('jwtSecret'));\n    req.user = decoded.user;\n    next();\n  } catch (err) {\n    res.status(401).json({\n      msg: 'Token is not valid'\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"script"}