{"ast":null,"code":"var md5 = require('blueimp-md5'),\n    querystring = require('querystring'),\n    MD5_REGEX = /^[0-9a-f]{32}$/;\n\nfunction params(options) {\n  var params = {},\n      removing = {\n    protocol: 1,\n    format: 1\n  };\n\n  for (var key in options) {\n    if (!removing[key]) params[key] = options[key];\n  }\n\n  return params;\n}\n\nfunction proto(options, protocol) {\n  if (!options) return;\n  if (typeof options.protocol === 'boolean') return options.protocol;\n  return options.protocol === \"http\" ? false : options.protocol === \"https\" ? true : undefined;\n}\n\nfunction getHash(email) {\n  email = typeof email === 'string' ? email.trim().toLowerCase() : 'unspecified';\n  return email.match(MD5_REGEX) ? email : md5(email);\n}\n\nfunction getQueryString(options) {\n  var queryData = querystring.stringify(params(options));\n  return queryData && \"?\" + queryData || \"\";\n}\n\nvar gravatar = module.exports = {\n  url: function (email, options, protocol) {\n    var baseURL = \"//www.gravatar.com/avatar/\";\n\n    if (options && options.cdn) {\n      baseURL = options.cdn + '/avatar/';\n      delete options.cdn;\n    } else {\n      if (options && options.protocol) protocol = proto(options);\n\n      if (typeof protocol !== 'undefined') {\n        baseURL = protocol ? \"https://s.gravatar.com/avatar/\" : 'http://www.gravatar.com/avatar/';\n      }\n    }\n\n    var query = getQueryString(options);\n    return baseURL + getHash(email) + query;\n  },\n  profile_url: function (email, options, https) {\n    var format = options != undefined && options.format != undefined ? String(options.format) : 'json';\n    var baseURL;\n\n    if (options && options.cdn) {\n      baseURL = options.cdn + '/';\n      delete options.cdn;\n    } else {\n      if (options && options.protocol) https = proto(options);\n      var baseURL = https && \"https://secure.gravatar.com/\" || 'http://www.gravatar.com/';\n    }\n\n    var query = getQueryString(options);\n    return baseURL + getHash(email) + '.' + format + query;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}